"use strict";(self.webpackChunklinkwell_nodes_documentation=self.webpackChunklinkwell_nodes_documentation||[]).push([[5846],{8087:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"services/direct-request-jobs/examples/coin-price-data/CryptoCompare","title":"Retrieving CryptoCompare data using Chainlink","description":"Code examples for writing CryptoCompare (cryptocurrency price) data to your smart contract using a Chainlink oracle request (custom data feed).","source":"@site/docs/services/direct-request-jobs/examples/coin-price-data/CryptoCompare.md","sourceDirName":"services/direct-request-jobs/examples/coin-price-data","slug":"/services/direct-request-jobs/examples/coin-price-data/CryptoCompare","permalink":"/services/direct-request-jobs/examples/coin-price-data/CryptoCompare","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Retrieving CryptoCompare data using Chainlink","description":"Code examples for writing CryptoCompare (cryptocurrency price) data to your smart contract using a Chainlink oracle request (custom data feed)."},"sidebar":"docsSidebar","previous":{"title":"Alpha-Vantage","permalink":"/services/direct-request-jobs/examples/stock-price-data/Alpha-Vantage"},"next":{"title":"IPFS","permalink":"/services/direct-request-jobs/examples/ipfs-data/IPFS"}}');var n=t(4848),i=t(8453);const s={title:"Retrieving CryptoCompare data using Chainlink",description:"Code examples for writing CryptoCompare (cryptocurrency price) data to your smart contract using a Chainlink oracle request (custom data feed)."},a="Retrieving CryptoCompare data using Chainlink",c={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Writing coin prices from CryptoCompare to your blockchain smart contract",id:"writing-coin-prices-from-cryptocompare-to-your-blockchain-smart-contract",level:2},{value:"1. Create a CryptoCompare API key",id:"1-create-a-cryptocompare-api-key",level:3},{value:"2. Design your consumer contract",id:"2-design-your-consumer-contract",level:3},{value:"2a. Add the constructor:",id:"2a-add-the-constructor",level:4},{value:"2b. Add your request function (example):",id:"2b-add-your-request-function-example",level:4},{value:"2c. Retrieve the response (example):",id:"2c-retrieve-the-response-example",level:4},{value:"Need to protect your API key?",id:"need-to-protect-your-api-key",level:3},{value:"Simulating the above request logic",id:"simulating-the-above-request-logic",level:2},{value:"1. <strong>Send the HTTP request</strong>:",id:"1-send-the-http-request",level:4},{value:"2. <strong>Analyze the response</strong>:",id:"2-analyze-the-response",level:4},{value:"3. <strong>Apply the JSON path</strong>:",id:"3-apply-the-json-path",level:4},{value:"4. <strong>Apply the multiplier</strong>:",id:"4-apply-the-multiplier",level:4},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Still need more help?",id:"still-need-more-help",level:2}];function d(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"retrieving-cryptocompare-data-using-chainlink",children:"Retrieving CryptoCompare data using Chainlink"})}),"\n",(0,n.jsx)(r.h2,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsx)(r.p,{children:"CryptoCompare is a digital platform that offers an extensive API tailored to the world of cryptocurrencies. The CryptoCompare API provides users with a wealth of information, including real-time and historical cryptocurrency price data, market analysis, and other vital metrics across a multitude of exchanges. This comprehensive data set is invaluable for traders, investors, researchers, and developers aiming to integrate cryptocurrency data into their applications or platforms. By offering a combination of accuracy, breadth, and ease of use, CryptoCompare has solidified its position as a go-to resource for those seeking reliable insights into the ever-evolving cryptocurrency market."}),"\n",(0,n.jsxs)(r.p,{children:["The following guide illustrates an easy example of how to retrieve a ",(0,n.jsx)(r.code,{children:"uint256"})," value from the CryptoCompare API, and write it to your blockchain smart contract using our highly-resilient Chainlink oracle infrastructure."]}),"\n",(0,n.jsx)(r.h2,{id:"writing-coin-prices-from-cryptocompare-to-your-blockchain-smart-contract",children:"Writing coin prices from CryptoCompare to your blockchain smart contract"}),"\n",(0,n.jsx)(r.p,{children:"Accessing CryptoCompare data from within your blockchain contract or Web3 application is as simple as:"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Creating an CryptoCompare API key through the CryptoCompare website."}),"\n",(0,n.jsx)(r.li,{children:"Deploying the following Chainlink consumer contract onto the ERC-20 blockchain network of your choice."}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Below we'll walk you through the steps necessary to implement such a solution."}),"\n",(0,n.jsx)(r.h3,{id:"1-create-a-cryptocompare-api-key",children:"1. Create a CryptoCompare API key"}),"\n",(0,n.jsx)(r.p,{children:"In order to retrieve data from the CryptoCompare API, you'll need an API key."}),"\n",(0,n.jsxs)(r.p,{children:["You may request a free API key from CryptoCompare here: ",(0,n.jsx)(r.a,{href:"https://min-api.cryptocompare.com/",children:"CryptoCompare Pricing Plans"})]}),"\n",(0,n.jsx)(r.p,{children:"Some CryptoCompare API requests such as this example don't require an API key, however."}),"\n",(0,n.jsx)(r.h3,{id:"2-design-your-consumer-contract",children:"2. Design your consumer contract"}),"\n",(0,n.jsxs)(r.p,{children:["Add the following sample code to your ",(0,n.jsx)(r.strong,{children:"consumer contract"}),"."]}),"\n",(0,n.jsx)(r.h4,{id:"2a-add-the-constructor",children:"2a. Add the constructor:"}),"\n",(0,n.jsxs)(r.p,{children:["The constructor specifies important information about the request destination and payment for your request. ",(0,n.jsx)(r.strong,{children:"Important"}),": This information varies by chain, oracle, and job:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-sol",metastring:"reference",children:"https://github.com/LinkWellNodes/Documentation/blob/main/docs/services/direct-request-jobs/examples/coin-price-data/CryptoCompare.sol#L23-L32\n"})}),"\n",(0,n.jsxs)(r.admonition,{type:"tip",children:[(0,n.jsx)(r.mdxAdmonitionTitle,{}),(0,n.jsxs)(r.p,{children:["You'll need to replace ",(0,n.jsx)(r.code,{children:"ADD_CHAINLINK_TOKEN_ADDRESS_HERE"}),", ",(0,n.jsx)(r.code,{children:"ADD_ORACLE_ADDRESS_HERE"}),", and ",(0,n.jsx)(r.code,{children:"ADD_JOB_ID_HERE"})," with the values appropriate to the specific blockchain network and job that you'll be using. You can find these values within our ",(0,n.jsx)(r.a,{href:"/services/direct-request-jobs/Jobs-and-Pricing",children:"Direct Request Job Documentation"}),". Chainlink token addresses can be found ",(0,n.jsx)(r.a,{href:"https://docs.chain.link/resources/link-token-contracts",children:"here"}),"."]})]}),"\n",(0,n.jsx)(r.h4,{id:"2b-add-your-request-function-example",children:"2b. Add your request function (example):"}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"request()"})," function defines the request parameters and sends a request to the Chainlink oracle. For detailed information on each required parameter, reference the above '",(0,n.jsx)(r.strong,{children:"Request parameters"}),"' section:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-sol",metastring:"reference",children:"https://github.com/LinkWellNodes/Documentation/blob/main/docs/services/direct-request-jobs/examples/coin-price-data/CryptoCompare.sol#L34-L55\n"})}),"\n",(0,n.jsx)(r.h4,{id:"2c-retrieve-the-response-example",children:"2c. Retrieve the response (example):"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-sol",metastring:"reference",children:"https://github.com/LinkWellNodes/Documentation/blob/main/docs/services/direct-request-jobs/examples/coin-price-data/CryptoCompare.sol#L57-L65\n"})}),"\n",(0,n.jsx)(r.h3,{id:"need-to-protect-your-api-key",children:"Need to protect your API key?"}),"\n",(0,n.jsx)(r.admonition,{type:"danger",children:(0,n.jsx)(r.p,{children:"Data entered into a smart contract is visible to the general public."})}),"\n",(0,n.jsxs)(r.p,{children:["If you'd like to protect your API key from being broadcast on-chain, you can instead store this information off-chain on our secure infrastructure. Please fill out our ",(0,n.jsx)(r.a,{href:"https://linkwellnodes.io/Getting-Started.html",children:"Request Survey"})," to get started - once we receive your information, we'll provide you with a custom job ID that will send your API key safely along with your request."]}),"\n",(0,n.jsx)(r.h2,{id:"simulating-the-above-request-logic",children:"Simulating the above request logic"}),"\n",(0,n.jsxs)(r.p,{children:["Let's walk through each step of the above ",(0,n.jsx)(r.strong,{children:"sample request"}),", to better understand how it all works together:"]}),"\n",(0,n.jsxs)(r.h4,{id:"1-send-the-http-request",children:["1. ",(0,n.jsx)(r.strong,{children:"Send the HTTP request"}),":"]}),"\n",(0,n.jsxs)(r.p,{children:["The following ",(0,n.jsx)(r.code,{children:"curl"})," command simulates the same HTTP request that our Chainlink node makes shortly after you trigger the ",(0,n.jsx)(r.code,{children:"request()"})," function within your consumer contract:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"curl -k -X 'GET' 'https://min-api.cryptocompare.com/data/pricemulti?fsyms=BTC,ETH&tsyms=USD,EUR' -H 'accept: application/json'\n"})}),"\n",(0,n.jsxs)(r.h4,{id:"2-analyze-the-response",children:["2. ",(0,n.jsx)(r.strong,{children:"Analyze the response"}),":"]}),"\n",(0,n.jsx)(r.p,{children:"The following is a sample response body returned to our Chainlink node by the above HTTP request (abbreviated for clarity):"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:'{\n  "BTC": {\n    "USD": 26034.14,\n    "EUR": 24082.32\n  },\n  "ETH": {\n    "USD": 1650.14,\n    "EUR": 1526.23\n  }\n}\n'})}),"\n",(0,n.jsxs)(r.h4,{id:"3-apply-the-json-path",children:["3. ",(0,n.jsx)(r.strong,{children:"Apply the JSON path"}),":"]}),"\n",(0,n.jsxs)(r.p,{children:["After receiving the above sample response, our Chainlink node will attempt to filter the result by the provided ",(0,n.jsx)(r.code,{children:"path"})," parameter value (",(0,n.jsx)(r.code,{children:"ETH,USD"}),"). After applying the provided path, we get the following result:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"1650.14\n"})}),"\n",(0,n.jsxs)(r.h4,{id:"4-apply-the-multiplier",children:["4. ",(0,n.jsx)(r.strong,{children:"Apply the multiplier"}),":"]}),"\n",(0,n.jsxs)(r.p,{children:["After filtering the sample response by the provided JSON path, our Chainlink node will multiply the result by the provided ",(0,n.jsx)(r.code,{children:"multiplier"})," parameter value (",(0,n.jsx)(r.code,{children:"10 ** 18"}),"). After applying this multiplier, we get the following value, which is ultimately written to your smart contract as a ",(0,n.jsx)(r.code,{children:"uint256"})," object by our Chainlink oracle:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"1650140000000000000000\n"})}),"\n",(0,n.jsx)(r.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,n.jsxs)(r.p,{children:["Having trouble with your request? Check our ",(0,n.jsx)(r.a,{href:"/knowledgebase/faq/Chainlink-Users#chainlink-direct-requests",children:"Chainlink Direct Requests FAQ"}),"."]}),"\n",(0,n.jsx)(r.admonition,{type:"caution",children:(0,n.jsxs)(r.p,{children:["This job has a configured gas limit of ",(0,n.jsx)(r.strong,{children:"1,000,000"})," for writing your result on-chain. If your transaction isn't returning any value after more than 60 seconds of waiting, use the appropriate block explorer to navigate to the '",(0,n.jsx)(r.strong,{children:"Oracle Address"}),"' you entered into your consumer contract for this job to see if any recent transaction(s) have failed due to an '",(0,n.jsx)(r.strong,{children:"out of gas"}),"' error. If so, you'll need to either A) Return a smaller response, B) Split your request into multiple oracle transactions, or C) Contact us to request a higher gas allowance for your specific use case (may result in higher job pricing)."]})}),"\n",(0,n.jsx)(r.h2,{id:"still-need-more-help",children:"Still need more help?"}),"\n",(0,n.jsxs)(r.p,{children:["Please reach out to us in ",(0,n.jsx)(r.a,{href:"https://discord.gg/Xs6SjqVPUA",children:"Discord"})," if you require additional assistance with this request."]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>s,x:()=>a});var o=t(6540);const n={},i=o.createContext(n);function s(e){const r=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),o.createElement(i.Provider,{value:r},e.children)}}}]);